<div class="file-upload-container mb-6">
  <div class="flex items-center gap-4">
    <div *ngIf="imagePreview; else noTemplate" class="image-preview">
      <img
        [src]="imagePreview"
        alt="Image preview"
        class="w-24 h-24 rounded-full object-cover"
      />
    </div>

    <ng-template #noTemplate>
      <div class="w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center">
        <i class="pi pi-user text-4xl text-gray-400"></i>
      </div>
    </ng-template>

    <div class="flex-1">
      <label for="profile-upload" class="file-upload-label">
        <span class="file-upload-icon"><i class="pi pi-upload"></i></span>
        <span class="file-upload-text">Upload Profile Picture</span>
        <input
          id="profile-upload"
          (change)="onFileChange($event)"
          class="file-input"
          type="file"
          accept="image/*"
        />
      </label>
      <p class="text-xs text-gray-500 mt-2">Headshot profile pictures are preferred (max 5MB)</p>
    </div>
  </div>
</div>

<form [formGroup]="headerInfoForm" (ngSubmit)="submitForm()">
  <div class="form-section">
    <div class="form-grid">
      <div class="form-field">
        <label for="firstname">First Name</label>
        <input pInputText id="firstname" formControlName="firstname" />
      </div>

      <div class="form-field">
        <label for="surname">Surname</label>
        <input pInputText id="surname" formControlName="surname" />
      </div>

      <div class="form-field">
        <label for="city">City</label>
        <input pInputText id="city" formControlName="city" />
      </div>

      <div class="form-field">
        <label for="country">Country</label>
        <input pInputText id="country" formControlName="country" />
      </div>

      <div class="form-field">
        <label for="postalCode">Postal Code</label>
        <input pInputText id="postalCode" formControlName="postalCode" />
      </div>

      <div class="form-field">
        <label for="phoneNumber">Phone Number</label>
        <input pInputText id="phoneNumber" formControlName="phoneNumber" />
      </div>

      <div class="form-field">
        <label for="email">Email Address</label>
        <input pInputText id="email" type="email" formControlName="email" />
      </div>

      <div class="form-field">
        <label for="dateOfBirth">Date of Birth</label>
        <p-calendar formControlName="dateOfBirth" id="dateOfBirth" styleClass="w-full" 
          (ngModelChange)="onDateChange($event)"></p-calendar>
      </div>
    </div>

    <!-- Social Fields -->
    <div class="social-fields-section">
      <h3 class="section-title">Social Links</h3>
      <div class="social-fields">
        <div
          *ngFor="let field of fields.controls; let i = index"
          [formGroup]="field"
          class="social-field-item"
        >
          <label [for]="'social-' + i">
            <i [class]="getFieldIcon(field.get('label')?.value)"></i>
            {{ field.get("label")?.value }}
          </label>
          <div class="social-input-group">
            <input
              type="text"
              pInputText
              formControlName="value"
              [id]="'social-' + i"
              [placeholder]="'Enter ' + field.get('label')?.value + ' URL'"
              class="social-input"
            />
            <p-button
              (onClick)="removeField(i)"
              severity="danger"
              [outlined]="true"
              icon="pi pi-trash"
              [text]="true"
              [rounded]="true"
              type="button"
            ></p-button>
          </div>
        </div>
      </div>

      <div class="social-buttons">
        <p-button
          *ngFor="let fieldType of fieldTypes"
          (onClick)="addField(fieldType)"
          severity="secondary"
          [outlined]="true"
          [rounded]="true"
          [label]="fieldType"
          icon="pi pi-plus"
          type="button"
        ></p-button>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="form-actions-footer">
      <p-button
        label="Cancel"
        severity="secondary"
        [outlined]="true"
        icon="pi pi-times"
        type="button"
      ></p-button>
      <p-button
        label="Save"
        type="submit"
        icon="pi pi-check"
      ></p-button>
    </div>
  </div>
</form>
